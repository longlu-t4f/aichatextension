import{i as c,a as u,b as f}from"./assets/messaging-CgRh-b1E.js";const o=new Map,r=new Map,m="src/sidepanel/index.html";chrome.runtime.onInstalled.addListener(async()=>{await chrome.sidePanel.setPanelBehavior({openPanelOnActionClick:!0})});chrome.webNavigation.onCommitted.addListener(e=>{e.documentId&&r.set(e.documentId,e.tabId)});chrome.tabs.onRemoved.addListener(e=>{o.delete(e);for(const[n,t]of r.entries())t===e&&r.delete(n)});chrome.runtime.onMessage.addListener((e,n)=>{if(!c(e))return!1;if(u(e)){const t=e,i=d(t.tabId,n);return i==null?!1:(p(t,i),!0)}if(f(e)){const i=d(e.tabId,n);return i==null?!1:(a(i,void 0,{dropAfterSend:!0}),!0)}return!1});function d(e,n){if(e!=null)return e;if(n.tab?.id!=null)return n.tab.id;if(n.documentId){const t=r.get(n.documentId);if(t!=null)return t}}function p(e,n){const t={...e,tabId:n};o.set(n,t),chrome.sidePanel.setOptions({tabId:n,path:h(n),enabled:!0}).catch(()=>{}),chrome.sidePanel.open({tabId:n}).catch(()=>{}),a(n,t,{dropAfterSend:!1})}function a(e,n,t){const i=n??o.get(e);if(!i)return;const l=t?.dropAfterSend??!0;chrome.runtime.sendMessage(i).then(()=>{l&&o.get(e)===i&&o.delete(e)},s=>{s&&typeof s.message=="string"&&s.message.includes("Receiving end does not exist")})}function h(e){return`${m}?tabId=${e}`}
